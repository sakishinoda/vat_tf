# vat_tf

<img src="https://github.com/takerum/vat_tf/raw/master/vat.gif" width="480">

Tensorflow implementation for reproducing the semi-supervised learning results on SVHN and CIFAR-10 dataset in the paper "Virtual Adversarial Training: a Regularization Method for Supervised and Semi-Supervised Learning" http://arxiv.org/abs/1704.03976

### Requirements
tensorflow-gpu 1.1.0, scipy(for ZCA whitening)

## Preparation of dataset for semi-supervised learning
On MNIST

```python mnist.py --data_dir=/tmp/mnist/dataset```

On CIFAR-10

```python cifar10.py --data_dir=./dataset/cifar10/```

On SVHN

```python svhn.py --data_dir=./dataset/svhn/```

## Semi-supervised Learning without augmentation 
On MNIST

```python train_semisup.py --dataset=mnist  --data_dir=/tmp/mnist/dataset --log_dir=/tmp/mnist/log --epsilon=5.0 --batchsize=64 --ul_batchsize=256 --method=vat --num_iter_per_epoch=1000 --num_epochs=100 --epoch_decay_start=50 --initial_learning_rate=0.002 --mom1=0.5 --mom2=0.5```

On CIFAR-10

```python train_semisup.py --dataset=cifar10 --data_dir=./dataset/cifar10/ --log_dir=./log/cifar10/ --num_epochs=500 --epoch_decay_start=460 --epsilon=10.0 --method=vat```

On SVHN

```python train_semisup.py --dataset=svhn --data_dir=./dataset/svhn/ --log_dir=./log/svhn/ --num_epochs=120 --epoch_decay_start=80 --epsilon=2.5 --top_bn --method=vat```

## Semi-supervised Learning with augmentation 
On CIFAR-10

```python train_semisup.py --dataset=cifar10 --data_dir=./dataset/cifar10/ --log_dir=./log/cifar10aug/ --num_epochs=500 --epoch_decay_start=460 --aug_flip=True --aug_trans=True --epsilon=8.0 --method=vat```

On SVHN

```python train_semisup.py --dataset=svhn --data_dir=./dataset/svhn/ --log_dir=./log/svhnaug/ --num_epochs=120 --epoch_decay_start=80 --epsilon=3.5 --aug_trans=True --top_bn --method=vat```

## Semi-supervised Learning with augmentation + entropy minimization
On CIFAR-10

```python train_semisup.py --dataset=cifar10 --data_dir=./dataset/cifar10/ --log_dir=./log/cifar10aug/ --num_epochs=500 --epoch_decay_start=460 --aug_flip=True --aug_trans=True --epsilon=8.0 --method=vatent```

On SVHN

```python train_semisup.py --dataset=svhn --data_dir=./dataset/svhn/ --log_dir=./log/svhnaug/ --num_epochs=120 --epoch_decay_start=80 --epsilon=3.5 --aug_trans=True --top_bn --method=vatent```


## Evaluation of the trained model
```python test.py --dataset=<cifar10 or svhn> --data_dir=<path_to_data_dir> --log_dir=<path_to_log_dir>```


